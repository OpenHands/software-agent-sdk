---
name: PR Review by OpenHands

on:
    # Use pull_request_target so the workflow can comment on PRs from forks.
    # Security: restrict execution to an explicit maintainer-applied label.
    pull_request_target:
        types: [labeled]

permissions:
    contents: read
    pull-requests: write
    issues: write

jobs:
    pr-review:
        # Security: only run when a maintainer applies the explicit label.
        if: github.event.label.name == 'review-this'
        concurrency:
            group: pr-review-${{ github.event.pull_request.number }}
            cancel-in-progress: true
        runs-on: ubuntu-24.04
        steps:
            - name: Run PR Review
              uses: OpenHands/software-agent-sdk/.github/actions/pr-review@main
              with:
                  # LLM model(s) to use. Can be comma-separated for A/B testing
                  # - one model will be randomly selected per review
                  llm-model: litellm_proxy/claude-sonnet-4-5-20250929
                  llm-base-url: https://llm-proxy.app.all-hands.dev
                  # Review style: roasted (other option: standard)
                  review-style: roasted
                  # Security: never execute untrusted PR code in this workflow.
                  # Use a trusted ref for the PR review tooling.
                  sdk-version: main
                  llm-api-key: ${{ secrets.LLM_API_KEY }}
                  github-token: ${{ github.token }}
                  lmnr-api-key: ${{ secrets.LMNR_SKILLS_API_KEY }}
